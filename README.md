# ç»™æ˜Ÿç©¹é“é“MMDæ¨¡å‹æ‰¹é‡æ·»åŠ æè´¨å’Œæè¾¹çš„Blenderæ’ä»¶

<p align="center">
<img alt="MIT License" src="https://img.shields.io/github/license/yetone/openai-translator.svg?style=flat-square"/>
<img alt="Python" src="https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&&logoColor=white" />
</p>

<p align="center">
ä¸­æ–‡ | <a href="README_EN.md">English</a>
</p>

- [ç»™æ˜Ÿç©¹é“é“MMDæ¨¡å‹æ‰¹é‡æ·»åŠ æè´¨å’Œæè¾¹çš„Blenderæ’ä»¶](#ç»™æ˜Ÿç©¹é“é“mmdæ¨¡å‹æ‰¹é‡æ·»åŠ æè´¨å’Œæè¾¹çš„blenderæ’ä»¶)
  - [è¯´æ˜](#è¯´æ˜)
  - [åŠŸèƒ½](#åŠŸèƒ½)
  - [å®‰è£…](#å®‰è£…)
    - [æ–¹å¼ä¸€ï¼šzip æ–¹å¼å®‰è£…ï¼ˆæ¨èï¼‰](#æ–¹å¼ä¸€zip-æ–¹å¼å®‰è£…æ¨è)
    - [æ–¹å¼äºŒï¼šè§£å‹åå®‰è£…](#æ–¹å¼äºŒè§£å‹åå®‰è£…)
  - [ä½¿ç”¨](#ä½¿ç”¨)
    - [ä½¿ç”¨æ•™ç¨‹](#ä½¿ç”¨æ•™ç¨‹)
    - [è´´å›¾æ•°æ®è¯´æ˜](#è´´å›¾æ•°æ®è¯´æ˜)
    - [è§’è‰²é…ç½®æ–‡ä»¶è¯´æ˜](#è§’è‰²é…ç½®æ–‡ä»¶è¯´æ˜)
    - [ä½¿ç”¨ä»£ç æ„å»ºè§’è‰²é…ç½®æ–‡ä»¶](#ä½¿ç”¨ä»£ç æ„å»ºè§’è‰²é…ç½®æ–‡ä»¶)
  - [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
  - [è§„åˆ™](#è§„åˆ™)
  - [è‡´è°¢](#è‡´è°¢)
  - [æ”¯æŒ](#æ”¯æŒ)



![3](./img/3.jpg)



1. æ­¤æ’ä»¶ç»“åˆä»¥ä¸‹***ä»¿æ˜Ÿç©¹é“é“ Shader***ä¸€èµ·ä½¿ç”¨ï¼š

   - Festivity's Honkai: Star Rail Shaderï¼Œåœ°å€ï¼šhttps://github.com/festivities/Blender-StellarToon

   - å…‹é‡Œæ–¯æäºšå¨œå¤§ä½¬çš„æ±‰åŒ–ä¿®å¤ï¼Œä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1JKwny2CkdfSmqR1jT51BiQ?from=init&pwd=26JU  **ç”¨è¿™ä¸ª** 


   - è¡¥ä¸€ä¸ªä¸‹è½½é“¾æ¥ï¼š[StellarToonæ˜Ÿç©¹é“é“ä¸­æ–‡ä¿®å¤ç‰ˆV3.blend](https://1drv.ms/u/s!AihGDbeGMmo3j5kJijuoFCh-PkxHtw?e=4XHsm1)


2. æ­¤æ’ä»¶éœ€è¦çš„**è§’è‰²é…ç½®æ–‡ä»¶**ï¼š

   - [xiaojubaoæ’ä»¶-æ˜Ÿç©¹é“é“-è§’è‰²é…ç½®æ–‡ä»¶å¤¹2024-05-08.zip](https://1drv.ms/u/s!AihGDbeGMmo3j5kQuY8A1PBqbN1g5Q?e=VVNO3Z) æå–ç ï¼š`%Tme5`ï¼ˆ**åŒ…å«55ä¸ªè§’è‰²çš„é…ç½®æ–‡ä»¶ï¼Œéƒ½æ˜¯æˆ‘ä¸€ä¸ªä¸€ä¸ªé…ç½®çš„**ï¼‰

   - ä¸‹æ–‡æœ‰å¦‚ä½•åˆ¶ä½œé…ç½®æ–‡ä»¶çš„æ•™ç¨‹ï¼Œæ²¡æœ‰çš„å¯ä»¥è‡ªå·±é…ä¸€ä¸‹(â‰§ï¹ â‰¦) 

â­ å¦‚æœä½ è§‰å¾—æœ‰ç”¨çš„è¯ï¼Œå¯ä»¥ç»™è¿™ä¸ªä»“åº“ç‚¹ä¸ª **Star**  â­

ğŸ”‹æ”¯æŒä¸€ä¸‹ï¼Œ[Bilibli@ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://space.bilibili.com/41350412) ï¼Œ[çˆ±å‘ç”µ@ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://afdian.net/a/xiaojubao)ğŸ”‹



æµ‹è¯•è¿‡çš„æ¨¡å‹ï¼šï¼ˆè‚ä¸åŠ¨äº†ï¼ï¹ï¼œ

![6](./img/6.jpg)

## è¯´æ˜

- ***StellarToon Shader ä»…æ”¯æŒ Blender GooEngine  åˆ†æ”¯***
- GooEngine 3.6 ç¯å¢ƒä¸‹å¼€å‘ï¼Œå…¶ä»–ç‰ˆæœ¬è‡ªè¡Œæµ‹è¯•çœ‹çœ‹ï¼Œåé¦ˆç»™æˆ‘ä¸‹

## åŠŸèƒ½

- æ‰¹é‡ç»™æ¨¡å‹æ·»åŠ  ***Blender-StellarToon Shader***ï¼Œä¿®æ”¹äº†åŸæœ‰é»˜è®¤çš„**é¢éƒ¨é˜´å½±**å’Œ**èº«ä½“è¾¹ç¼˜å…‰åšåº¦**
- æ‰¹é‡ç»™æ¨¡å‹æ·»åŠ /ç§»é™¤ **ç¯å…‰çŸ¢é‡ä¿®æ”¹å™¨**
- æ‰¹é‡ç»™æ¨¡å‹æ·»åŠ /ç§»é™¤ ***Blender-StellarToon æè¾¹***ï¼Œå°†**æè¾¹åšåº¦**ä½œä¸ºå‚æ•°æš´éœ²äº†å‡ºæ¥ï¼Œæ–¹ä¾¿ä¿®æ”¹

æ’ä»¶æˆªå›¾

![4](./img/4.jpg)

åç»­æ›´æ–°ï¼š

- [ ] æ­¦å™¨
- [ ] é¢éƒ¨æè¾¹ä¿®å¤
...
- å¯ä»¥å…³æ³¨ä¸‹ï¼Œåç»­ä¹Ÿä¼šåšå…¶ä»–çš„å·¥å…·æ’ä»¶

## å®‰è£…

### æ–¹å¼ä¸€ï¼šzip æ–¹å¼å®‰è£…ï¼ˆæ¨èï¼‰

[ä¸‹è½½ - xiaojubao-honkai-star-rail.zip](https://github.com/foxlynna/xiaojubao-honkai-star-rail/releases)

ä¸‹è½½ zip ç›´æ¥åœ¨Blender æ’ä»¶ç®¡ç†é¢æ¿å®‰è£…ï¼Œ**ä¸ç”¨è§£å‹**ã€‚

### æ–¹å¼äºŒï¼šè§£å‹åå®‰è£…

è§£å‹åè‡ªè¡Œæ”¾å…¥Blenderæ’ä»¶æ–‡ä»¶å¤¹ï¼Œä¸€èˆ¬æ˜¯ `ç”¨æˆ·\AppData\Roaming\Blender Foundation\Blender\ä½ çš„ç‰ˆæœ¬å·\scripts\addons`ä¸‹

## ä½¿ç”¨

### ä½¿ç”¨æ•™ç¨‹

[æ•™ç¨‹ - @ä½•ä»¥åƒå¥ˆçš„æ©˜å­ bilibili](https://www.bilibili.com/video/BV1JT421X7v3)



å®‰è£…åï¼Œæ‰“å¼€ N çª—ï¼Œå‡ºç° ***XiaoJu*** æ ‡ç­¾é¡µã€‚

- ***shader blend æ–‡ä»¶è·¯å¾„***ï¼šè¾“å…¥ä¸‹è½½çš„ festivity Blender-StellarToon blend æ–‡ä»¶ `StellarToonæ˜Ÿç©¹é“é“ä¸­æ–‡ä¿®å¤ç‰ˆV3.blend`
- ***è§’è‰²çš„è´´å›¾è·¯å¾„*** - è´´å›¾æ•°æ®è¯´æ˜è§ä¸‹æ–‡
- ***è§’è‰²çš„é…ç½®æ–‡ä»¶*** - é…ç½® ***MMD æ¨¡å‹***  å„éƒ¨åˆ†***ç½‘æ ¼åç§°ä¸Sharderçš„æ˜ å°„*** - ä¸‹è½½ä»¥åŠå¦‚ä½•é…ç½®è§ä¸‹æ–‡
- æ³¨ï¼šå¡«å…¥çš„è·¯å¾„å‚æ•°ä¼šç¼“å­˜ä¸‹æ¥ï¼Œå…³é—­é¡¹ç›®åï¼Œä¸‹æ¬¡æ‰“å¼€ç©ºé¡¹ç›®ä¼šè‡ªåŠ¨å¡«å…¥ Ïˆ(ï½€âˆ‡Â´)Ïˆ ä¼šæ–¹ä¾¿å¾ˆå¤š

- é€‰ä¸­è§’è‰²çš„ç½‘æ ¼å¯¹è±¡ï¼Œç‚¹å‡»å„ä¸ªæŒ‰é’®å¼€å§‹æ¢­å“ˆ......ãƒ¾(â‰§â–½â‰¦*)o

### è´´å›¾æ•°æ®è¯´æ˜

- è§’è‰²è´´å›¾å•ç‹¬æ”¾ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹
- ä¸€èˆ¬åº”è¯¥åŒ…å«ï¼šï¼ˆä»¥å¸ƒæ´›å¦®å¨… è´´å›¾ä¸ºä¾‹ï¼šï¼‰
  - è„¸éƒ¨è´´å›¾ï¼š
    - W_160_Maid_FaceMap_00.png      
    - Avatar_Bronya_00_Face_Color.png
  - å¤´å‘è´´å›¾
    - Avatar_Bronya_00_Hair_Color.png
    - Avatar_Bronya_00_Hair_Cool_Ramp.png
    - Avatar_Bronya_00_Hair_Warm_Ramp.png
    - Avatar_Bronya_00_Hair_LightMap.png
  - èº«ä½“è´´å›¾ï¼ˆæœ‰çš„æ¨¡å‹ä¸åˆ†Body1ã€2ï¼‰
    - Avatar_Bronya_00_Body_Cool_Ramp.png
    - Avatar_Bronya_00_Body_Warm_Ramp.png
    - Avatar_Bronya_00_Body1_Color.png
    - Avatar_Bronya_00_Body1_LightMap.png
    - Avatar_Bronya_00_Body2_Color.png
    - Avatar_Bronya_00_Body2_LightMap.png
- æ’ä»¶åŒ¹é…è´´å›¾ä½¿ç”¨çš„å…³é”®å­—ï¼šFaceMapã€Face_Colorã€Hair_Colorã€Hair_Cool_Rampã€Hair_Warm_Rampã€Hair_LightMapã€Body_Cool_Rampã€Body_Warm_Rampã€Body1_Colorã€Body1_LightMapã€Body2_Colorã€Body2_LightMapã€Body_Colorã€Body_LightMapï¼›
- **æ‰€ä»¥è´´å›¾æœ€å¥½ä¸è¦æœ‰é‡å¤çš„å…³é”®å­—ï¼Œæˆ–è€…ä¸ä¸€è‡´çš„å…³é”®å­—**ã€‚æ³¨ï¼š**ä»£ç ä¸­æœ‰å¤„ç†ä¸€éƒ¨åˆ†é€»è¾‘ï¼Œä½†æ˜¯æœ€å¥½æ£€æŸ¥ä¸€ä¸‹**ï¼Œä¿®æ”¹æ­£ç¡®ã€‚

<img src="./img/5.jpg" alt="2" style="zoom:80%;" />



### è§’è‰²é…ç½®æ–‡ä»¶è¯´æ˜

ç”±äºMMDçš„æ¨¡å‹æŒ‰æè´¨åˆ†å¼€åï¼Œç½‘æ ¼å¾ˆå¤šï¼Œä¸ºæ¯ä¸ªç½‘æ ¼æ­£ç¡®åœ°æ˜ å°„Shaderï¼Œæ‰€ä»¥æ·»åŠ äº†è¿™ä¹ˆä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚

ç»“æ„å¦‚ä¸‹ï¼šä¸»è¦æ˜¯ä½¿ç”¨ `face/hair/body/body1/body2` è¿™äº›Keyå»æ˜ å°„å¯¹åº”çš„ Shaderã€‚**æ³¨ï¼šåªæœ‰Keyä¸‹é¢çš„ç½‘æ ¼æ‰ä¼šè¢«æ·»åŠ Shader**ã€‚

- face å¯¹åº”ä½¿ç”¨ é¢éƒ¨ Shader
- hair å¯¹åº”ä½¿ç”¨ å¤´å‘ Shader
- body/body1/body2 å¯¹åº”ä½¿ç”¨ èº«ä½“çš„ Shader

```json
{
    "role_name": "Bronya_å¸ƒæ´›å¦®å¨…",
    "material_map": {
        "è¡¨æƒ…": [
            "è¡¨æƒ…"
        ],
        "body1": [
            "è¡£é¥°",
            "èƒ¸é¥°",
            "è¢–å­",
            "è¢–å­é¥°",
            "è¢–å­å¸¦",
            "è¢–å­å¸¦é¥°",
            "è¢–å­å¸¦1",
            "å†…è¡£",
            "è¡£æœ",
            "æ‰‹å¥—",
            "è€³ç¯",
            "å¤´é¥°",
            "å¤´é¥°é“",
            "çš®è‚¤"
        ],
        "body2": [
            "è…¿ç”²",
            "é‹å­",
            "é‹å­1",
            "ä¸è¢œ",
            "è¡£é¥°1",
            "è£™é¥°",
            "è£™å­",
            "è£™å­1"
        ],
        "è£™å†…ä¾§": [
            "è£™å­å†…ä¾§"
        ],
        "hair": [
            "å¤´å‘"
        ],
        "face": [
            "è„¸",
            "çœ‰æ¯›",
            "ç‰™é½¿",
            "èˆŒå¤´",
            "å£è…”",
            "çœ¼ç™½",
            "çœ¼ç›",
            "çœ¼ç›1"
        ]
    }
}
```

### ä½¿ç”¨ä»£ç æ„å»ºè§’è‰²é…ç½®æ–‡ä»¶

1. å°†ä»£ç åˆ°å¤åˆ¶åˆ°***blender è„šæœ¬é¡µé¢*** 

2. ä¿®æ”¹ä»£ç ä¸­çš„**è¾“å‡ºè·¯å¾„ã€è¾“å‡ºæ–‡ä»¶å**

3. **é€‰ä¸­è§’è‰²çš„ç½‘æ ¼**åæ‰§è¡Œä»£ç ç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚

4. ä¿®æ”¹é…ç½®æ–‡ä»¶çš„keyä¸ºï¼š`face/hair/body/body1/body2`

```python
import json
import os
import bpy

def collect_image_references():
    """read original model material and collect tex image"""
    image_map = {}
    for obj in bpy.context.selected_objects:
        if obj.type == 'MESH':
            if obj.material_slots:
                for slot in obj.material_slots:
                    if slot.material and slot.material.use_nodes:
                        nodes = slot.material.node_tree.nodes
                        for node in nodes:
                            if node.type == 'TEX_IMAGE' and node.image:
                                image_name = node.image.name
                                # remove .png
                                if image_name.lower().endswith('.png'):
                                    image_name = image_name[:-4]
                                # get mesh name and split by '_'
                                mesh_name_parts = obj.name.split('_')
                                if len(mesh_name_parts) > 1:
                                    mesh_name = mesh_name_parts[1]
                                else:
                                    mesh_name = mesh_name_parts[0]
                                if image_name not in image_map:
                                    image_map[image_name] = []
                                if mesh_name not in image_map[image_name]:
                                    image_map[image_name].append(mesh_name)
    print(image_map)
    return image_map

def write_role_json(role_name, image_map, filepath):
    """write_role_json to json file"""
    full_file_path = os.path.join(filepath, f"{role_name}.json")
    print(full_file_path)
    # data structure
    data_to_write = {
        "role_name": role_name,
        "material_map": {
            
        }
    }
    # image_map add to data
    for key, value in image_map.items():
        data_to_write["material_map"][key] = value
        
    # Ensure the directory exists
    os.makedirs(os.path.dirname(full_file_path), exist_ok=True)
    # Write json
    with open(full_file_path, 'w', encoding='utf-8') as json_file:
        json.dump(data_to_write, json_file, ensure_ascii=False, indent=4)
    print(f"Data successfully written to {full_file_path}")

path = "å†™å‡ºçš„è·¯å¾„"
write_role_json("Bronya_å¸ƒæ´›å¦®å¨…", collect_image_references(), path)    
```



## å¸¸è§é—®é¢˜

- è´´å›¾åç§°é”™è¯¯ï¼šå¦‚ï¼šæœ‰çš„èº«ä½“è´´å›¾æ²¡æœ‰`Body`å­—æ®µ
- è´´å›¾å…³é”®å­—åç§°é‡å¤ï¼šå¦‚ï¼šèº«ä½“è´´å›¾åŒ…å«ï¼š`Body_Color`ã€`Body_Color_L`ï¼Œæ’ä»¶æœ‰å¤„ç†è¿™éƒ¨åˆ†é€»è¾‘

- éƒ¨åˆ†æè´¨æ²¡ä¸Šæ˜¯æš—è‰²çš„ï¼Œåˆ†ææƒ…å†µï¼Œå¯æ‰‹åŠ¨åˆ‡æ¢åˆ°æ­£ç¡®çš„æè´¨çƒ

- ...

- è§£å†³ä¸äº†å¯æissueï¼Œæˆ–è€…Bç«™ç§ä¿¡æˆ‘ã€‚[@ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://space.bilibili.com/41350412) 



## è§„åˆ™

- AGPL 3.0 licence
- å¦‚æœä½¿ç”¨æ­¤æ’ä»¶ï¼Œå¯ä»¥å£°æ˜Shaderä½œè€… [festivity](https://github.com/festivities)ï¼Œæ±‰åŒ–ä¿®å¤ï¼š[å…‹é‡Œæ–¯æäºšå¨œ](https://space.bilibili.com/322607631?spm_id_from=333.788.0.0)ï¼Œæ’ä»¶ä½œè€…ï¼š[ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://space.bilibili.com/41350412) 



## è‡´è°¢

- [festivity](https://github.com/festivities)

- [å…‹é‡Œæ–¯æäºšå¨œ](https://space.bilibili.com/322607631?spm_id_from=333.788.0.0)

- [HoYoverse](https://www.hoyoverse.com/)

- [DillonGoo Studios](https://www.dillongoostudios.com/)



## æ”¯æŒ

åˆ¶ä½œä¸æ˜“ï¼Œæ„Ÿè°¢ã€‚

ğŸ”‹æ”¯æŒä¸€ä¸‹ï¼Œ[Bilibli@ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://space.bilibili.com/41350412) ï¼Œ[çˆ±å‘ç”µ@ä½•ä»¥åƒå¥ˆçš„æ©˜å­](https://afdian.net/a/xiaojubao)ğŸ”‹











